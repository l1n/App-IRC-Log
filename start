#!/usr/bin/env raku

use IRC::Log::Colabti:ver<0.0.26>:auth<cpan:ELIZABETH>;
use Cro::HTTP::Server:ver<0.8.5>;

use lib 'lib';
use App::IRC::Log;

my $ail := App::IRC::Log.new:
  log-class     => IRC::Log::Colabti,
  log-dir       => "logs",
  html-dir      => "html",
  templates-dir => "templates",
  state-dir     => 'state',
;

my $application := $ail.application;

my $service := Cro::HTTP::Server.new:
  :host<localhost>,
  :port<10000>,
  :application($ail.application),
;
$service.start;

react whenever signal(SIGINT) {
    $service.stop;
    $ail.shutdown;
    exit;
}
